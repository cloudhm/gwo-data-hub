# 产品开发定价表和采购表说明

## 概述

已创建以下业务表模型，用于存储产品开发和采购相关数据：

### 表命名规则

所有业务表都使用统一的前缀规则，便于分类管理：
- **开发相关表**: `ads_dev_*` - 产品开发定价相关
- **采购相关表**: `ads_purchase_*` - 采购管理相关
- **运营相关表**: `ads_ops_*` - 运营配置相关（税率、佣金等）

### 产品开发定价表（2个）
1. **普通型产品开发定价表** (`ads_dev_pricing_normal`)
2. **活动型产品开发定价表** (`ads_dev_pricing_promotion`)

### 采购相关表（8个）
3. **每日产品信息表** (`ads_purchase_daily_product_info`)
4. **含税账号统计表** (`ads_purchase_tax_account_statistics`)
5. **新品时间表** (`ads_purchase_new_product_timeline`)
6. **产品采购汇总表** (`ads_purchase_summary`)
7. **样品采购汇总表** (`ads_purchase_sample_summary`)
8. **付款信息表** (`ads_purchase_payment_info`)
9. **采购订单到货追踪表** (`ads_purchase_order_tracking`)
10. **帐期货款待付明细表** (`ads_purchase_account_period_payment_detail`)

### 税率佣金信息表（3个）
11. **汇率信息表** (`ads_ops_currency_exchange_rate`)
12. **VAT计算参考表** (`ads_ops_vat_calculation_reference`)
13. **账号佣金表** (`ads_ops_account_commission`)

### 运营定价相关表（6个）
14. **COGS普通型定价表** (`ads_ops_cogs_pricing_normal`)
15. **COGS活动型定价表** (`ads_ops_cogs_pricing_promotion`)
16. **EU-SC店铺定价表** (`ads_ops_eu_sc_pricing`)
17. **US-SC店铺定价表** (`ads_ops_us_sc_pricing`)
18. **接单价表** (`ads_ops_received_price`)
19. **产品规格及箱规表** (`ads_ops_product_specification`)

## 表结构

### 普通型产品开发定价表

包含以下字段：
- 产品名称
- 竞品单价
- 目的国
- 运输方式
- 真实售价（前端）
- 不含税售价（前端）
- 亚马逊FBA
- 亚马逊佣金
- 亚马逊毛利
- 亚马逊毛利率
- 亚马逊净利润
- 亚马逊净利润率
- 公司毛利(EUR)
- 公司毛利率(%)
- SC利润
- 供货价（欧元）
- 采购价(RMB)
- 采购占比（27%）
- 头程(RMB)
- 转运费(EUR)
- 物流占比（15%）
- AVS佣金(EUR)
- 广告推广费(EUR)
- 欧元汇率
- 装箱数
- 重量 MAX（实重或体积重）
- 运费单价(RMB)
- 转运费（EUR）

### 活动型产品开发定价表

包含以下字段：
- 产品名称
- 竞品价格
- 目的国
- 运输方式
- 实际价格（前端）
- Deal 折扣（BD 85折）
- 折后价（前端）
- 折后不含税价（前端）
- 亚马逊FBA
- 亚马逊佣金
- 亚马逊毛利
- 亚马逊毛利率
- 亚马逊净利润
- 亚马逊净利润率
- 公司毛利(EUR)
- 公司毛利率(%)
- 供货价（欧元）
- 采购价(RMB)
- 头程(RMB)
- 转运费(EUR)
- AVS佣金(EUR)
- 广告推广费(EUR)
- 欧元汇率
- 装箱数
- 重量
- 运费单价
- 转运费（EUR）

## 使用步骤

### 1. 生成数据库迁移

运行以下命令生成迁移文件：

```bash
npx prisma migrate dev --name add_purchase_and_pricing_tables
```

### 2. 添加列注释

在迁移完成后，运行以下 SQL 脚本来为所有列添加中文注释：

```bash
psql -d your_database_name -f prisma/add_column_comments.sql
```

或者直接在数据库客户端中执行 `prisma/add_column_comments.sql` 文件中的 SQL 语句。

### 3. 生成 Prisma Client

运行以下命令重新生成 Prisma Client：

```bash
npx prisma generate
```

## 模型关联

所有表都通过 `accountId` 字段关联到 `LingXingAccount` 模型，支持一个账户下可以有多个记录。

### 唯一键约束

- **每日产品信息表**: `accountId + sku` 唯一
- **含税账号统计表**: `accountId + sku` 唯一
- **新品时间表**: `accountId + sku` 唯一
- **产品采购汇总表**: `accountId + orderNumber` 唯一
- **样品采购汇总表**: `accountId + orderNumber` 唯一
- **付款信息表**: `accountId + sku` 唯一
- **采购订单到货追踪表**: `accountId + systemPoNumber` 唯一
- **帐期货款待付明细表**: `accountId + orderNumber` 唯一
- **汇率信息表**: `accountId + currency + time` 唯一
- **VAT计算参考表**: `accountId + site` 唯一
- **账号佣金表**: `accountId + accountName` 唯一

## 采购相关表结构

### 每日产品信息表

包含以下字段：
- SKU
- 品名
- 外箱规格长
- 外箱规格宽
- 外箱规格高
- 外箱规格单位
- 单箱数量(pcs)
- 单箱重量
- 单箱重量单位

### 含税账号统计表

包含以下字段：
- SKU
- 产品名称
- 供应商
- 户名
- 账号
- 银行
- 开户行
- 发票名称
- 单位规格
- 发票源地
- 开票编码
- 海关编码【供应商提供】
- 海关编码【近期使用】
- 发票税点
- 备注（扣的税点）
- 备注

### 新品时间表

包含以下字段：
- SKU
- 品名
- 开发人
- 运营
- 创建时间
- 下单时间
- 到深仓时间
- 深圳发出时间
- 物流方式
- 到库日期

### 产品采购汇总表

包含以下字段：
- 订单编号
- 供应商
- 下单日期
- 品名
- SKU
- 单价
- 采购量
- 运费
- 税额
- 采购金额
- 付款方式
- 订单类型
- 系统PO号
- 单据类型
- 账期天数
- 最后到货日
- 到期付款日
- 付款金额1
- 付款时间1
- 付款金额2
- 付款时间2
- 折扣金额
- 已付金额
- 退款金额
- 未付金额
- 其他备注
- 订单编号2
- xt是否请款
- jw不含税单价
- 总单价

### 样品采购汇总表

包含以下字段：
- 订单编号
- 供应商
- 下单时间
- 品名
- 单价
- 采购量
- 运费
- 采购金额
- 付款方式
- 是否退款
- 退款金额
- 请款时间
- 已请款金额
- 未请款金额
- 备注

### 付款信息表

包含以下字段：
- SKU
- 产品名称
- 供应商
- 户名
- 账号
- 开户行
- 发票名称
- 单位规格
- 发票源地
- 开票编码
- 海关编码【供应商提供】
- 海关编码【近期使用】
- 发票税点
- 备注（扣的税点）
- 备注
- 身份证号码

### 采购订单到货追踪表

包含以下字段：
- 系统PO号
- 运营
- 下单日期
- 品名
- SKU
- 单价
- 采购量
- 运费
- 采购金额
- 付款方式
- 订单类型
- 单箱数量
- 箱数
- 预计到货时间(PMC)
- 预计到货时间(供应商）
- 签收时间
- 备注

### 帐期货款待付明细表

包含以下字段：
- 订单编号
- 产品名称
- 采购数量
- 订单总金额
- 付款方式
- 账期天数
- 最后到货日
- 结算日期
- 应付金额
- 供应商
- PO号
- 备注
- 供应商-收款户名
- 供应商-开户银行
- 供应商-收款账号
- 付款方

## 税率佣金信息表结构

### 汇率信息表

包含以下字段：
- 货币名称（如：欧元、英镑）
- 汇率
- 时间（如：2025年12月）

### VAT计算参考表

包含以下字段：
- 站点（如：DE、FR、IT、ES、UK、NL）
- 【增值税】VAT占比（如：15.96%）
- 税后价（如：84.04%）

### 账号佣金表

包含以下字段：
- 账号（如：Dhohoo、AKASO）
- 佣金（如：16.80%）

## 运营定价相关表结构

### COGS普通型定价表

包含以下字段：
- 更新时间
- 店铺编号-PO类型
- 运营
- ASIN
- UPC
- 产品名称
- 目的国
- 售价（前端）
- 不含税售价（前端）
- 亚马逊FBA运费
- 亚马逊佣金
- 亚马逊毛利
- 亚马逊毛利率
- 亚马逊净利润
- 亚马逊净利润率
- 公司毛利(EUR)
- 公司毛利率(%)
- SC利润
- 供货价（欧元）
- 采购价(RMB)
- 采购占比
- 头程(RMB)
- 转运费(EUR)
- 物流占比
- AVS佣金(EUR)
- 广告推广费(EUR)
- 欧元汇率
- 装箱数
- 重量 MAX（实重或体积重）
- 运费单价(RMB/kg)
- 转运费（EUR/箱）
- 财务核对

### COGS活动型定价表

包含以下字段：
- 更新时间
- 店铺编号-PO类型
- 运营
- ASIN
- UPC
- 产品名称
- 目的国
- 建议售价（前端）
- Deal 折扣（BD 85折）
- 折后价（前端）
- 折后不含税价（前端）
- 亚马逊FBA
- 佣金
- 亚马逊毛利
- 亚马逊毛利率
- 亚马逊净利润
- 亚马逊净利润率
- 公司毛利(EUR)
- 公司毛利率(%)
- 供货价（欧元）
- 采购价(RMB)
- 头程(RMB)
- 单件转运费(EUR)
- AVS佣金(EUR)
- 广告推广费(EUR)
- 欧元汇率
- 装箱数
- 重量kg
- 运费单价
- 转运费（EUR）
- 转运费（EUR）财务核对分站点
- 转运费（EUR）财务核对不分站点

### EU-SC店铺定价表

包含以下字段：
- 更新时间
- 店铺
- ASIN
- UPC
- 产品名称
- 目的国
- 前台售价
- 亚马逊佣金
- VAT税金
- 亚马逊FBA
- 采购价
- 头程
- 广告推广费
- 毛利额(RMB)
- 毛利率
- 欧元汇率
- 装箱数
- 重量 MAX kg（实重或体积重）
- 采购单价(RMB)
- 头程单价(RMB)
- 运费单价(RMB/kg)
- 中转单价(RMB)

### US-SC店铺定价表

包含以下字段：
- 更新时间
- 店铺
- ASIN
- UPC
- 产品名称
- 目的国
- 前台售价
- 亚马逊佣金
- VAT税金
- 亚马逊FBA
- 采购价
- 头程
- 广告推广费
- 毛利额(RMB)
- 毛利率
- 美金汇率
- 装箱数
- 重量 MAX kg（实重或体积重）
- 采购单价(RMB)
- 头程单价(RMB)
- 运费单价(RMB/kg)
- 中转单价(RMB)

### 接单价表

包含以下字段：
- 月份
- 产品名称
- 运营
- ASIN
- 国家
- 接单价（€）
- 运营确认记录
- 更新

### 产品规格及箱规表

包含以下字段：
- 月份
- ASIN
- UPC
- 产品
- 负责人
- 包装重量（g）
- 产品尺寸-长（CM）
- 产品尺寸-宽（CM）
- 产品尺寸-高（CM）
- 箱规
- 装箱(PCS)

## 索引

所有表都创建了相应的索引以优化查询性能：
- `accountId` - 账户ID索引（所有表）
- `sku` - SKU索引（相关表）
- `productName` - 产品名称索引（相关表）
- `orderNumber` - 订单编号索引（相关表）
- `supplier` - 供应商索引（相关表）
- `currency` - 货币索引（汇率信息表）
- `time` - 时间索引（汇率信息表）
- `site` - 站点索引（VAT计算参考表）
- `accountName` - 账号名称索引（账号佣金表）
- `asin` - ASIN索引（运营定价相关表）
- `upc` - UPC索引（运营定价相关表）
- `store` - 店铺索引（店铺定价表）
- `storeNumberPoType` - 店铺编号-PO类型索引（COGS定价表）
- `operator` - 运营索引（运营相关表）
- `month` - 月份索引（接单价表、产品规格表）
- `country` - 国家索引（接单价表）
- `updateTime` - 更新时间索引（定价表）
- `createdAt` - 创建时间索引（所有表）
- 其他业务相关索引（根据表的具体需求）

